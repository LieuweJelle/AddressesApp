<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>add members</title>
 	<link rel="stylesheet" href="prism.css" />
	<link rel="stylesheet" type="text/css" href="members.css" />
	<script src="https://code.jquery.com/jquery-3.2.1.js"></script>
	<script src="FileSaver.js"></script>
  <script>
// https://www.youtube.com/watch?v=rJesac0_Ftw // ajaj!
// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Working_with_Objects
function addCSS() {
  $(".button")
		.css("font-size", "12pt")
		.css("padding", "4px 12px")
		.css("border", "1px solid #ac0000")
		.css("color", "#ac0000")
		.width(160); 
	$(".button").hover(function(){
		$(this).css("font-weight", "bold");
		$(this).css("border", "1px solid #A8015C");
		$(this).css("color", "#A8015C");
		//$(this).css("background-color", "yellow");
		}, function(){ // AND restore!
		 $(this).css("font-weight", "normal");    
		 $(this).css("border", "1px solid #ac0000");
		 $(this).css("color", "#ac0000");
		//$(this).css("background-color", "pink");
	});
}

var arrayList = [];
var index = 0; var id = 1;
var jSonCounter2;
/*function editMember() {
	var result = this.forename + ' ' + this.lastname + ' ' + this.address;
	return result;
}	*/
function Member(forename, lastname, address, zipcode, city, telephone, email) {
	this.forename = forename;
	this.lastname = lastname;
	this.address = address;
	this.zipcode = zipcode;
	this.city = city;
	this.telephone = telephone;
	this.email = email;
	//this.editMember = editMember;
}

function validate(flag) {
	if(flag==='add') {
		fail  = validateForename(forename.value);
		fail += validateLastname(lastname.value);
		fail += validateAddress(address.value);
		fail += validateZipcode(zipcode.value);
		fail += validateCity(city.value);
		fail += validateTelephone(telephone.value);
		fail += validateEmail(email.value);
	} else if(flag==='edit') {
		fail  = validateForename(forename1.value);
		fail += validateLastname(lastname1.value);
		fail += validateAddress(address1.value);
		fail += validateZipcode(zipcode1.value);
		fail += validateCity(city1.value);
		fail += validateTelephone(telephone1.value);
		fail += validateEmail(email1.value);
	}
	if (fail == "") {
		return true;
	} else { 
		alert(fail);
		return false;
	}
}
function validateForename(field) {
	return (field == "") ? "Geen voornaam ingevuld.\n" : "";
}
function validateLastname(field) {
	return (field == "") ? "Geen achternaam ingevuld.\n" : "";
}
function validateAddress(field) {
	if (field == "") {
		return "Geen adres ingevuld.\n";
	} else if (field.length < 5) {
		return "Adres moet zeker 5 karakters lang zijn.\n";
	} else if (/[^a-zA-Z0-9_ -]/.test(field)) {
		return "Alleen a-z, A-Z, 0-9, - en / zijn toegestaan in adres.\n";
	}
	return "";
}
function validateZipcode(field) {
	if (field == "") {
		return "Geen postcode ingevuld.\n";
	} else if (field.length < 6) {
		return "Postcode moet 6 karakters .\n";
	} else if (/[^a-zA-Z0-9]/.test(field)) {
		return "Alleen a-z, A-Z en 0-9 zijn toegestaan in postcode.\n";
	}
	return "";
}
function validateCity(field) {
	if (field == "") {
		return "Geen woonplaats ingevuld.\n";
	} else if (field.length < 4) {
		return "Woonplaats moet zeker 4 karakters lang zijn.\n";
	} else if (/[^a-zA-Z0-9_ -]/.test(field)) {
		return "Alleen a-z, A-Z, 0-9, - en / zijn toegestaan in adres.\n";
	}
	return "";
}
function validateTelephone(field) {
	if (field == "") {
		return "Geen telefoonnummer ingevuld.\n";
	} else if (isNaN(field)) {
		return "Telefoonnummer is geen nummer.\n";
	} else if (field.length < 10) {
		return "Telefoonnummer moet 10 karakters groot zijn.\n";
	}
	return "";
}
function validateEmail(field) {
	if (field == "") {
		return "Geen email ingevuld.\n";
	}	else if (!((field.indexOf(".") > 0) && (field.indexOf("@") > 0)) || /[^a-zA-Z0-9.@_-]/.test(field)) {
	//} else if (/[^a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(field)) {
		return "Het email adres bestaat niet.\n";
	}
	return "";
}

function add(array) { //test-functie
  arrayList = array;
	index = arrayList.length;
	arrayList.push(new Member("Matheus Marcus", "Baksteen", "Rofplein 11", "9876GG", "Harkema", "0614232314", "mm@theoffice.org"));
	arrayList.push(new Member("Gepkinus", "Brouwer", "Noorderbinnensingel 1", "6543XZ", "Groningen", "06666666666", "gepper@home.fl"));
	var row = "";
	for(index; index<arrayList.length; index++) {
		row += "<tr class='inner'>"+
		"	<td class='user_table_txt'>"+(id++)+"</td>"+
		"	<td class='user_table_txt2'>"+ arrayList[index].forename +"</td>"+
		"	<td class='user_table_txt2'>"+ arrayList[index].lastname +"</td>"+
		"	<td class='user_table_txt'>"+ arrayList[index].address +"</td>"+
		"	<td class='user_table_txt'>"+ arrayList[index].zipcode +"</td>"+
		"	<td class='user_table_txt'>"+ arrayList[index].city +"</td>"+
		"	<td class='user_table_txt'>"+ arrayList[index].telephone +"</td>"+
		"	<td class='user_table_a'><a href='useradmin.php'>"+ arrayList[index].email +"</a></td>"+
		"	<td class='user_table_a'><a href='' onclick='event.preventDefault();"+
			"edit(arrayList["+index+"], "+(index)+")'>Wijzigen</a></td>"+
		"	<td class='user_table_a'><a href='' onclick='event.preventDefault();"+
			"del(arrayList["+index+"], "+(index)+")'>Verwijderen</a></td>"+
		"</tr>";
	}
  tablehelper.insertAdjacentHTML('beforeend', row);
}
function edit(member, pos) {
	var html = '';
	var index = pos;
	html += "<div class='main'><span class='namefield'>&nbsp;</span><h3>Adres wijzigen</h3>"+
	"<div id='fieldspace'></div><span class='namefield'>Voornaam</span>"+
	"<input type='text' size='46' maxlength='40' name='forename1' id='forename1' value='"+member.forename+"' /><br />"+
	"<div id='fieldspace'></div><span class='namefield'>Achternaam</span>"+
	"<input type='text' size='46' maxlength='40' name='lastname1' id='lastname1' value='"+member.lastname+"' /><br />"+
	"<div id='fieldspace'></div><span class='namefield'>Adres</span>"+
	"<input type='text' size='46' maxlength='40' name='address1' id='address1' value='"+member.address+"' /><br />"+
	"<div id='fieldspace'></div><span class='namefield'>Postcode</span>"+
	"<input type='text' size='46' maxlength='7' name='zipcode1' id='zipcode1' value='"+member.zipcode+"' /><br />"+
	"<div id='fieldspace'></div><span class='namefield'>Woonplaats</span>"+
	"<input type='text' size='46' maxlength='40' name='city1' id='city1' value='"+member.city+"' /><br />"+
	"<div id='fieldspace'></div><span class='namefield'>Telefoon</span>"+
	"<input type='text' size='46' maxlength='10' name='telephone1' id='telephone1' value='"+member.telephone+"' /><br />"+
	"<div id='fieldspace'></div><span class='namefield'>Email</span>"+
	"<input type='text' size='46' maxlength='40' name='email1' id='email1' value='"+member.email+"' /><br />"+
	"<div id='fieldspace'></div><div id='fieldspace'></div>"+   
	"<span class='namefield'>&nbsp;</span>"+
	"<button id='edit' class='button'>Gegevens Wijzigen</button>"+
	"</div>";
	document.getElementById("editdiv").innerHTML=html;
	addCSS();
	$("#edit").on("click", function() {
		 $(this).css({"color": "red", "border": "1px solid red"});
		var val1 = $("#forename1").val();
		var val2 = $("#lastname1").val();
		var val3 = $("#address1").val();
		var val4 = $("#zipcode1").val();
		var val5 = $("#city1").val();
		var val6 = $("#telephone1").val();
		var val7 = $("#email1").val();
		if(validate('edit')) {
			arrayList.splice(index, 1, new Member(val1,val2,val3,val4,val5,val6,val7));
			createJsonFile(arrayList);
			var subelem1 = $("<td></td>").html("<a href='' onclick='event.preventDefault();'>"+ val7 +"</a>");
			var elem = $("<tr></tr>").addClass('inner');
			$(elem).append("<td class='user_table_txt'>"+(index+1)+"</td>")
						 .append("<td class='user_table_txt2'>"+val1+"</td>")
						 .append("<td class='user_table_txt2'>"+val2+"</td>")
						 .append("<td class='user_table_txt'>"+val3+"</td>")
						 .append("<td class='user_table_txt'>"+val4+"</td>")
						 .append("<td class='user_table_txt'>"+val5+"</td>")
						 .append("<td class='user_table_txt'>"+val6+"</td>")
						 //.append("<td>"+val7+"</td>").addClass('user_table_txt')
						 .append(subelem1).addClass('user_table_a')  // a becomes the class!
						 .append("<td class='user_table_a'><a href='' onclick='event.preventDefault();"+
							"edit(arrayList["+(arrayList.length-1)+"], "+(arrayList.length-1)+")'>Wijzigen</a></td>")
						 .append("<td class='user_table_a'><a href='' onclick='event.preventDefault();"+
							"del(arrayList["+(arrayList.length-1)+"], "+(arrayList.length-1)+")'>Verwijderen</a></td>");
			$("#flextable > tbody > tr:nth-child("+(index+1)+")").after(elem);
			$("#flextable > tbody > tr:nth-child("+(index+1)+")").remove();
			//localStorage.setItem(id, new Member(val1,val2,val3,val4,val5,val6,val7);
			console.log(arrayList[index].forename);
		}/*end validate*/
	});
}

function del(member, pos) {
	var html = '';
	var index = pos;
	html += "<div class='main'><span class='namefield'>&nbsp;</span><h3>Adres verwijderen</h3>"+
	"<div id='fieldspace'></div><span class='namefield'>Voornaam</span>"+
	"<input type='text' size='46' maxlength='40' name='forename1' id='forename1' value='"+member.forename+"' readonly /><br />"+
	"<div id='fieldspace'></div><span class='namefield'>Achternaam</span>"+
	"<input type='text' size='46' maxlength='40' name='lastname1' id='lastname1' value='"+member.lastname+"' readonly /><br />"+
	"<div id='fieldspace'></div><span class='namefield'>Adres</span>"+
	"<input type='text' size='46' maxlength='40' name='address1' id='address1' value='"+member.address+"' readonly /><br />"+
	"<div id='fieldspace'></div><span class='namefield'>Postcode</span>"+
	"<input type='text' size='46' maxlength='7' name='zipcode1' id='zipcode1' value='"+member.zipcode+"' readonly /><br />"+
	"<div id='fieldspace'></div><span class='namefield'>Woonplaats</span>"+
	"<input type='text' size='46' maxlength='40' name='city1' id='city1' value='"+member.city+"' readonly /><br />"+
	"<div id='fieldspace'></div><span class='namefield'>Telefoon</span>"+
	"<input type='text' size='46' maxlength='10' name='telephone1' id='telephone1' value='"+member.telephone+"' readonly /><br />"+
	"<div id='fieldspace'></div><span class='namefield'>Email</span>"+
	"<input type='text' size='46' maxlength='40' name='email1' id='email1' value='"+member.email+"' readonly /><br />"+
	"<div id='fieldspace'></div>"+
	"<div id='fieldspace'></div>"+   
	"<span class='namefield'>&nbsp;</span>"+
	"<button id='delete' class='button'>Gegevens Verwijderen</button>"+
	"</div>";
	document.getElementById("editdiv").innerHTML=html;
	addCSS();
	$("#delete").on("click", function() {
		console.log(arrayList[index].forename + " verwijderd!");
		arrayList.splice(index,1);
		createJsonFile(arrayList);
		$("#flextable > tbody > tr:nth-child("+(index+1)+")").remove();
		sortAddresses(arrayList);
		//localStorage.setItem(id, new Member(val1,val2,val3,val4,val5,val6,val7);
		document.getElementById("editdiv").innerHTML='';
	});
}

function createJsonFile(array) {
	var row = '[' ;
	var i;
	for(i = 0; i<array.length; i++) {
		row += '{\n';
		row += '"forename": "'+ array[i].forename +'",\n';
		row += '"lastname": "'+ array[i].lastname +'",\n';
		row += '"address": "'+ array[i].address +'",\n';
		row += '"zipcode": "'+ array[i].zipcode +'",\n';
		row += '"city": "'+ array[i].city +'",\n';
		row += '"telephone": "'+ array[i].telephone +'",\n';
		row += '"email": "'+ array[i].email +'"\n';
		if(i===array.length-1) {
			row += '}';
		} else {
			row += '},\n';
		}
	}
	row += ']';
	document.getElementById("textarea").value = row;
}	
function addAddresses(jsObj) {
	index = arrayList.length;
	var row = "";
	for(var i = 0; i<jsObj.length; i++) {
		arrayList.push(new Member(jsObj[i].forename, jsObj[i].lastname, jsObj[i].address, jsObj[i].zipcode, jsObj[i].city, jsObj[i].telephone, jsObj[i].email));
		row += "<tr class='inner'>"+
		"	<td class='user_table_txt'>"+(++index)+"</td>"+
		"	<td class='user_table_txt2'>"+ jsObj[i].forename +"</td>"+
		"	<td class='user_table_txt2'>"+ jsObj[i].lastname +"</td>"+
		"	<td class='user_table_txt'>"+ jsObj[i].address +"</td>"+
		"	<td class='user_table_txt'>"+ jsObj[i].zipcode +"</td>"+
		"	<td class='user_table_txt'>"+ jsObj[i].city +"</td>"+
		"	<td class='user_table_txt'>"+ jsObj[i].telephone +"</td>"+
		"	<td class='user_table_a'><a href='#'>"+ jsObj[i].email +"</a></td>"+
		"	<td class='user_table_a'><a href='#' onclick='edit(arrayList["+(index-1)+"],"+(index-1)+")'>Wijzigen</a></td>"+
		"	<td class='user_table_a'><a href='#' onclick='del(arrayList["+(index-1)+"],"+(index-1)+")'>Verwijderen</a></td>"+
		"</tr>";
		//localStorage.setItem(index+1,JSON.stringify(arrrayList[index]));
	}
	//document.getElementById("tablehelper").innerHTML='';
  tablehelper.insertAdjacentHTML('beforeend', row);
	createJsonFile(arrayList);
	for(var i = 0; i<jsObj.length; i++) {
		console.log(arrayList[i]);
		//console.log(localStorage.getItem(i+1));
	}
}
function sortAddresses(array, col) {
	if(col===1) {
		array.sort(function(a, b){
			var x = a.forename.toLowerCase();
			var y = b.forename.toLowerCase();
			if (x < y) {return -1;}
			if (x > y) {return 1;}
			return 0;
		});
	} else if (col===2) {
		array.sort(function(a, b){
			var x = a.lastname.toLowerCase();
			var y = b.lastname.toLowerCase();
			if (x < y) {return -1;}
			if (x > y) {return 1;}
			return 0;
		});
	}
	index = array.length;
	var row = "";
	for(var i = 0; i<array.length; i++) {
		row += "<tr class='inner'>"+
		"	<td class='user_table_txt'>"+(i+1)+"</td>"+
		"	<td class='user_table_txt2'>"+ array[i].forename +"</td>"+
		"	<td class='user_table_txt2'>"+ array[i].lastname +"</td>"+
		"	<td class='user_table_txt'>"+ array[i].address +"</td>"+
		"	<td class='user_table_txt'>"+ array[i].zipcode +"</td>"+
		"	<td class='user_table_txt'>"+ array[i].city +"</td>"+
		"	<td class='user_table_txt'>"+ array[i].telephone +"</td>"+
		"	<td class='user_table_a'><a href='' onclick='event.preventDefault();'>"+ array[i].email +"</a></td>"+
		"	<td class='user_table_a'><a href='' onclick='event.preventDefault();edit(arrayList["+(i)+"],"+i+")'>Wijzigen</a></td>"+
		"	<td class='user_table_a'><a href='' onclick='event.preventDefault();del(arrayList["+(i)+"],"+i+")'>Verwijderen</a></td>"+
		"</tr>";
	}
	document.getElementById("tablehelper").innerHTML=row; //TODO
  //tablehelper.insertAdjacentHTML('beforeend', row);
}
  </script>
</head>
<body>
<table class="table"><tr><td>
	<div class='main'><span class='namefield'>&nbsp;</span><h3>Adressen toevoegen</h3>
		<div id='fieldspace'></div><span class='namefield'>Voornaam</span>
		<input type='text' size='46'	maxlength='40' name='forename' id='forename' /><br />
		<div id='fieldspace'></div><span class='namefield'>Achternaam</span>
		<input type='text' size='46'	maxlength='40' name='lastname' id='lastname' /><br />
		<div id='fieldspace'></div><span class='namefield'>Adres</span>
		<input type='text' size='46' maxlength='40' name='address' id='address' /><br />
		<div id='fieldspace'></div><span class='namefield'>Postcode</span>
		<input type='text' size='46'	maxlength='7' name='zipcode' id='zipcode' /><br />
		<div id='fieldspace'></div><span class='namefield'>Woonplaats</span>
		<input type='text' size='46'	maxlength='40' name='city' id='city' /><br />
		<div id='fieldspace'></div><span class='namefield'>Telefoon</span>
		<input type='text' size='46'	maxlength='10' name='telephone' id='telephone' /><br />
		<div id='fieldspace'></div><span class='namefield'>Email</span>
		<input type='text' size='46' maxlength='40' name='email' id='email' /><br />
		<div id='fieldspace'></div><div id='fieldspace'></div>   
		<!-- <span class='namefield'>&nbsp;</span> -->
		<button id="add" class='button'>Gegevens Toevoegen</button>
		<button id="reset" class='button'>Opnieuw</button>
	</div>
</td><td>
	<div id="editdiv"></div>
</td></tr></table>

<div class='main'>
	<table class="table" cellpadding="0" cellspacing="0" border="0" width="1000">
	<tr><td><img src="clear.gif" width="1px" height="5px"></td></tr>
	<tr>
		<td align="left"><span class="user_list_header"><img src="clear.gif" width="10px" height="1px">Adressen boekje</span></td>
		<td align="center"><span class="user_list_options"><span class="hide">[</span>&nbsp;
		<a href="" onclick="event.preventDefault();" id="xadd">Adressenbestand toevoegen</a>&nbsp;<span class="hide">]</span></span></td>
		<td align="right"><span class="user_list_options">[ <a href="" onclick="event.preventDefault();" id="submit2">Alle gegevens opslaan</a> |
		<a href="" onclick="event.preventDefault();" id="xdel">Alle gegevens wissen</a> ]<img src="clear.gif" width="10px" height="1px"></span></td>
	</tr>
	<!-- <tr><td><img src="clear.gif" width="1px" height="1px"></td></tr> -->
	</table><div id='fieldspace'></div><div id="fieldspace"></div>
	<table class="table" cellpadding="0" cellspacing="0" border="0" bgcolor="#000000"><tr><td>
		<table id="flextable" cellspacing="1" cellpadding="3" border="0" width="100%">
		<thead><tr class='header'>
			<td><span class="user_table_col_label">Nr.</span></td>
			<td><span class="user_table_col_label">Naam</span></td>
			<td><span class="user_table_col_label">Achternaam</span></td>
			<td><span class="user_table_col_label">Adres</span></td>
			<td><span class="user_table_col_label">Postcode</span></td>
			<td><span class="user_table_col_label">Woonplaats</span></td>
			<td><span class="user_table_col_label">Telefoon</span></td>
			<td><span class="user_table_col_label">Email</span></td>
			<td colspan="2"><span class="user_table_col_label">Mutaties</span></td>
		</tr></thead>
		<tbody id="tablehelper"></tbody>
		<!-- <tbody id="tablehelper2"></tbody> -->
		</table></td></tr>
	</table><div id='fieldspace'></div><div id="fieldspace"></div>
	<button id="sort1" class="button" name="sort">Index op voornaam</button>
	<button id="sort2" class="button" name="sort">Index op achternaam</button><br />
	<textarea id="textarea" class="textarea" rows="9" cols="50" readonly></textarea><br />
	<button id="json" class="button" name="json" onclick="$('#textarea').toggle(2000);">jSon Bekijken</button><br />
	<div id="fieldspace"></div><div id="fieldspace"></div>
	<button id="broncode" class="button" name="broncode" onclick="$('#aas').toggle(2000);">Broncode Bekijken</button><br />
	<iframe src="addressesappsource.html" width="1184" height="510" id="aas" class="aas"></iframe>
	<div id="fieldspace"></div><div id="fieldspace"></div>
	<button id="csscode" class="button" name="csscode" onclick="$('#css').toggle(2000);">Style sheet Bekijken</button><br />
	<iframe src="memberssource.html" width="1184" height="310" id="css" class="css"></iframe>
	<div id="fieldspace"></div><div id="fieldspace"></div>
	<button id="upload" class="button" name="upload" onclick="$('#upload').toggle(2000);">jSon Uploaden</button><br />
	<div id="fieldspace"></div><div id="fieldspace"></div>
	<button id="help" class="button" name="help" onclick="$('#help').toggle(2000);">???</button><br />
	<div id="fieldspace"></div><div id="fieldspace"></div>
	<input type="submit" id="submit" class="button" value="Alle Gegevens Opslaan" name="submit" /><br />
	<br />
	
<input type="file" id="myFile" multiple size="50" onchange="myFunction()">
<p id="demo"></p>
</div>
<script>
var file;
function myFunction(){
	var x = document.getElementById("myFile");
	var txt = "";
	if ('files' in x) {
		if (x.files.length == 0) {
			txt = "Select one or more files.";
		} else {
			for (var i = 0; i < x.files.length; i++) {
				txt += "<br><strong>" + (i+1) + ". file</strong><br>";
				file = x.files[i];
				if ('name' in file) {
					txt += "name: " + file.name + "<br>";
				}
				if ('size' in file) {
					txt += "size: " + file.size + " bytes <br>";
				}
			}
		}
	} else {
		if (x.value == "") {
			txt += "Select one or more files.";
		} else {
			txt += "The files property is not supported by your browser!";
			txt  += "<br>The path of the selected file: " + x.value; // If the browser does not support the files property, it will return the path of the selected file instead. 
		}
	}
	document.getElementById("demo").innerHTML = txt;
	var ourData;
	var ourRequest = new XMLHttpRequest();
	//ourRequest.overrideMimeType("application/json");
	ourRequest.open('GET', file.name);
	ourRequest.onload = function() {
		if (ourRequest.status >= 200 && ourRequest.status < 400) {
			ourData = JSON.parse(ourRequest.responseText);
			getAddresses(ourData);
			//add(arrayList);
		} else {
			console.log("We connected to the server, but it returned an error.");
		}
	};
	ourRequest.onerror = function() {
		console.log("Connection error");
	};
	ourRequest.send();
}

$('#textarea').hide();
$('#aas').hide();
$('#css').hide();
jSonCounter = 0;
var ourData;
var ourRequest = new XMLHttpRequest();
ourRequest.open('GET', 'adressen'+ jSonCounter +'.json');
ourRequest.onload = function() {
	if (ourRequest.status >= 200 && ourRequest.status < 400) {
		ourData = JSON.parse(ourRequest.responseText);
		addAddresses(ourData);
		//add(arrayList);
	} else {
		console.log("We connected to the server, but it returned an error.");
	}
};
ourRequest.onerror = function() {
	console.log("Connection error");
};
ourRequest.send();

function getAddresses(jsObj) {
	var row = "";
	for(var i = 0; i<jsObj.length; i++) {
	arrayList.push(new Member(jsObj[i].forename, jsObj[i].lastname, jsObj[i].address, jsObj[i].zipcode, jsObj[i].city, jsObj[i].telephone, jsObj[i].email));
		row += "<tr class='inner'>"+
		"	<td class='user_table_txt'>"+(id++)+"</td>"+
		"	<td class='user_table_txt2'>"+ arrayList[i].forename +"</td>"+
		"	<td class='user_table_txt2'>"+ arrayList[i].lastname +"</td>"+
		"	<td class='user_table_txt'>"+ arrayList[i].address +"</td>"+
		"	<td class='user_table_txt'>"+ arrayList[i].zipcode +"</td>"+
		"	<td class='user_table_txt'>"+ arrayList[i].city +"</td>"+
		"	<td class='user_table_txt'>"+ arrayList[i].telephone +"</td>"+
		"	<td class='user_table_a'><a href='' onclick='event.preventDefault();"+
			"'>"+ arrayList[i].email +"</a></td>"+
		"	<td class='user_table_a'><a href='' onclick='event.preventDefault();"+
			"edit(arrayList["+i+"],"+i+")'>Wijzigen</a></td>"+
		"	<td class='user_table_a'><a href='' onclick='event.preventDefault();"+
			"del(arrayList["+i+"],"+i+")'>Verwijderen</a></td>"+
		"</tr>";
	}
	//document.getElementById("tablehelper").innerHTML=row;
	tablehelper.insertAdjacentHTML('beforeend', row);
	createJsonFile(arrayList);
	for(var i = 0; i<jsObj.length; i++) {
		console.log(arrayList[i]);
		//console.log(localStorage.getItem(i+1));
	}
}
jSonCounter2 = 1;
var ourData2;
var xadd = document.getElementById("xadd");
xadd.addEventListener("click", function() {
	var ourRequest = new XMLHttpRequest();
	ourRequest.open('GET', 'adressen'+ jSonCounter2+'.json');
	ourRequest.onload = function() {
		if (ourRequest.status >= 200 && ourRequest.status < 400) {
			ourData2 = JSON.parse(ourRequest.responseText);
			addAddresses(ourData2);
		} else {
			console.log("We connected to the server, but it returned an error.");
		}
	};
	ourRequest.onerror = function() {
		console.log("Connection error");
	};
	ourRequest.send();
	jSonCounter2++;
	if (jSonCounter2 > 3) {
		xadd.classList.add("hide-me");
		$(".hide").hide(2000);
	}
});
	
$(function() {
	$("#submit").on("click", function() {
		jSonObj = document.getElementById("textarea").value;
		filename = "addressen4.json";
		var blob = new Blob([jSonObj], {type: "application/json;charset=utf-8"});
		saveAs(blob, filename);
	}); //??
	$("#submit2").on("click", function() {
		jSonObj = document.getElementById("textarea").value;
		filename = "addressen4.json";
		var blob = new Blob([jSonObj], {type: "application/json;charset=utf-8"});
		saveAs(blob, filename);
	});
	//$("#json").on("click", function() { });
	//var xdel = document.getElementById("xdel");
	//xdel.addEventListener("click", function() { });
	$("#xdel").on("click", function() {
		var index = arrayList.length;
		arrayList.splice(0,index);
		createJsonFile(arrayList);
		sortAddresses(arrayList);
		jSonCounter2 = 0;
		xadd.classList.remove("hide-me");
		$(".hide").show(2000);
	});
	$("#sort1").on("click", function() {
		sortAddresses(arrayList,1);
	});
	$("#sort2").on("click", function() {
		sortAddresses(arrayList,2);
	});
	$("#add").on("click", function() {
		var val1 = $("#forename").val();
		var val2 = $("#lastname").val();
		var val3 = $("#address").val();
		var val4 = $("#zipcode").val();
		var val5 = $("#city").val();
		var val6 = $("#telephone").val();
		var val7 = $("#email").val();
		if(validate('add')) {
		arrayList.push(new Member(val1, val2, val3, val4, val5, val6, val7));
			console.log(arrayList.length);
			createJsonFile(arrayList);
			var subelem1 = $("<td></td>").html("<a href='' onclick='event.preventDefault();'>"+ val7 +"</a>");
			var elem = $("<tr></tr>").addClass('inner');
			$(elem).append("<td class='user_table_txt'>"+(id++)+"</td>")
						 .append("<td class='user_table_txt2'>"+val1+"</td>")
						 .append("<td class='user_table_txt2'>"+val2+"</td>")
						 .append("<td class='user_table_txt'>"+val3+"</td>")
						 .append("<td class='user_table_txt'>"+val4+"</td>")
						 .append("<td class='user_table_txt'>"+val5+"</td>")
						 .append("<td class='user_table_txt'>"+val6+"</td>")
						 //.append("<td>"+val7+"</td>").addClass('user_table_txt')
						 .append(subelem1).addClass('user_table_a')  // a becomes the class!
						 .append("<td class='user_table_a'><a href='' onclick='event.preventDefault();"+
							"edit(arrayList["+(arrayList.length-1)+"], "+(arrayList.length-1)+")'>Wijzigen</a></td>")
						 .append("<td class='user_table_a'><a href='' onclick='event.preventDefault();"+
							"del(arrayList["+(arrayList.length-1)+"], "+(arrayList.length-1)+")'>Verwijderen</a></td>");
			$("#tablehelper").append(elem); //$("#tablehelper2").append(elem);
			$("#forename").val("");
			$("#lastname").val("");
			$("#address").val("");
			$("#zipcode").val("");
			$("#city").val("");
			$("#telephone").val("");
			$("#email").val("");
			//$(".remove").on("click", function() {
			//	$(this).parentsUntil("tbody").remove();
			//});
		}
	});
	$("#reset").on("click", function() {
		$("#forename").val("");
		$("#lastname").val("");
		$("#address").val("");
		$("#zipcode").val("");
		$("#city").val("");
		$("#telephone").val("");
		$("#email").val("");
	});
});
addCSS();
createJsonFile(arrayList);
</script>
<script src="prism.js"></script>
</body>
</html>